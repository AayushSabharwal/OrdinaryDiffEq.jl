struct ESDIRK4Tableau{T,T2}
    γ::T
    a31::T
    a32::T
    a41::T
    a42::T
    a43::T
    bhat1::T
    bhat2::T
    bhat3::T
    bhat4::T
    c3::T2
end

function Kvaerno3Tableau(T,T2)
  γ   = T(0.4358665215)
  a31 = T(0.490563388419108)
  a32 = T(0.073570090080892)
  a41 = T(0.308809969973036)
  a42 = T(1.490563388254106)
  a43 = -T(1.235239879727145)
  bhat1 = T(0.490563388419108)
  bhat2 = T(0.073570090080892)
  bhat3 = T(0.4358665215)
  bhat4 = T(0.0)
  c3 = T2(1)
  ESDIRK4Tableau(γ,a31,a32,a41,a42,a43,bhat1,bhat2,bhat3,bhat4,c3)
end

function KenCarp3Tableau(T,T2)
  γ  = T(1767732205903//4055673282236)
  a31 = T(2746238789719//10658868560708)
  a32 = -T(640167445237//6845629431997)
  a41 = T(1471266399579//7840856788654)
  a42 = -T(4482444167858//7529755066697)
  a43 = T(11266239266428//11593286722821)
  bhat1 = T(2756255671327//12835298489170)
  bhat2 = -T(10771552573575//22201958757719)
  bhat3 = T(9247589265047//10645013368117)
  bhat4 = T(2193209047091//5459859503100)
  c3 = T2(3//5)
  ESDIRK4Tableau(γ,a31,a32,a41,a42,a43,bhat1,bhat2,bhat3,bhat4,c3)
end

struct Cash4Tableau{T,T2}
  γ::T
  a21::T
  a31::T
  a32::T
  a41::T
  a42::T
  a43::T
  a51::T
  a52::T
  a53::T
  a54::T
  b1hat1::T
  b2hat1::T
  b3hat1::T
  b4hat1::T
  c2::T2
  c3::T2
  c4::T2
end

function Cash4Tableau(T,T2)
  γ = T(0.435866521508)
  a21 = T(-1.13586652150)
  a31 = T(1.08543330679)
  a32 = -T(0.721299828287)
  a41 = T(0.416349501547)
  a42 = T(0.190984004184)
  a43 = T(-0.118643265417)
  a51 = T(0.896869652944)
  a52 = T(0.0182725272734)
  a53 = -T(0.0845900310706)
  a54 = -T(0.266418670647)
  b1hat1 = T(1.05646216107052)
  b2hat1 = -T(0.0564621610705236)
  b3hat1 = T(0)
  b4hat1 = T(0)
  b1hat2 = T(0.776691932910)
  b2hat2 = T(0.0297472791484)
  b3hat2 = -T(0.0267440239074)
  b4hat2 = T(0.220304811849)
  c2 = -T2(0.7)
  c3 = T2(0.8)
  c4 = T2(0.924556761814)

  Cash4Tableau(γ,a21,a31,a32,a41,a42,a43,a51,a52,a53,a54,
               b1hat1,b2hat1,b3hat1,b4hat1,c2,c3,c4)
end

struct Hairer4Tableau{T,T2}
  γ::T
  a21::T
  a31::T
  a32::T
  a41::T
  a42::T
  a43::T
  a51::T
  a52::T
  a53::T
  a54::T
  b1hat1::T
  b2hat1::T
  b3hat1::T
  b4hat1::T
  c2::T2
  c3::T2
  c4::T2
end

function Hairer4Tableau(T,T2)
  γ = T(1//4)
  c2 = T(3//4)
  c3 = T(11//20)
  c4 = T(1//2)

  α21 = T(2)
  α31 = T(42//25)
  α32 = -T(4//25)
  α41 = T(89//68)
  α42 = -T(25//136)
  α43 = T(15//136)
  α51 = -T(37//12)
  α52 = -T(103//24)
  α53 = T(275//8)
  α54 = -T(85//3)

  e1 = -T(23//6)
  e2 = -T(17//12)
  e3 = T(125//4)
  e4 = -T(85//3)
  d11 = T(61//27)
  d12 = T(-185//54)
  d13 = T(2525//18)
  d14 = T(-3740//27)
  d15 = T(-44//9)
  d21 = T(2315//81)
  d22 = T(1049//162)
  d23 = T(-27725//54)
  d24 = T(40460//81)
  d25 = T(557//27)
  d31 = T(-6178//81)
  d32 = T(-1607//81)
  d33 = T(20075//27)
  d34 = T(-56440//81)
  d35 = T(-718//27)
  d41 = T(3680//81)
  d42 = T(1360//81)
  d43 = T(-10000//27)
  d44 = T(27200//81)
  d45 = T(320//27)
  ETA1= T(3)
  #=
  # Prediction alphas from Hairer
  # Predict z3 from z1 and z2
  A = [c1 c2
  γ*c1 a21*c1+γ*c2]
  b = [c3,a31*c1+a32*c2+γ*c3]
  =#
  ANU1= T(88//100)
  ANU2= T(44//100)
  #=
  # Predict z4 from z1 and z3
  A = [c1   c3
       γ*c1 a31*c1+a32*c2+γ*c3]
  b = [c4,a41*c1+a42*c2+a43*c3+γ*c4]

  a11 = 1//4
  a21 = 1//2
  a22 = 1//4
  a31 = 17//50
  a32 = -1//25
  a33 = 1//4
  a41 = 371//1360
  a42 = -137//2720
  a43 = 15//544
  a44 = 1//4
  a51 = 25//24
  a52 = -49//48
  a53 = 125//16
  a54 = -85//12
  a55 = 1//4

  A\b
  =#
  AMU1= T(3//17)
  AMU3= T(155//187)
end



function Hairer42Tableau(T,T2)
  γ  = T(4//15)
  c2 = T2(23//30)
  c3 = T2(17//30)
  c4 = T2(2881//28965)+γ
  α21 = T(15//8)
  α31 = T(1577061//922880)
  α32 = -T(23427//115360)
  α41 = T(647163682356923881//2414496535205978880)
  α42 = -T(593512117011179//3245291041943520)
  α43 = T(559907973726451//1886325418129671)
  α51 = T(724545451//796538880)
  α52 = -T(830832077//267298560)
  α53 = T(30957577//2509272)
  α54 = -T(69863904375173//6212571137048)
  e1 = T(7752107607//11393456128)
  e2 = -T(17881415427//11470078208)
  e3 = T(2433277665//179459416)
  e4 = -T(96203066666797//6212571137048)
  d11 = T(24.74416644927758)
  d12 = -T(4.325375951824688)
  d13 = T(41.39683763286316)
  d14 = T(-61.04144619901784)
  d15 = T(-3.391332232917013)
  d21 = T(-51.98245719616925)
  d22 = T(10.52501981094525)
  d23 = T(-154.2067922191855)
  d24 = T(214.3082125319825)
  d25 = T(14.71166018088679)
  d31 = T(33.14347947522142)
  d32 = T(-19.72986789558523)
  d33 = T(230.4878502285804)
  d34 = T(-287.6629744338197)
  d35 = T(-18.99932366302254)
  d41 = T(-5.905188728329743)
  d42 = T(13.53022403646467)
  d43 = T(-117.6778956422581)
  d44 = T(134.3962081008550)
  d45 = T(8.678995715052762)
  η = T(23//8)
  ANU1 = T(0.9838473040915402)
  ANU2 = T(0.3969226768377252)
  AMU1 = T(0.6563374010466914)
  AMU3 = T(0.3372498196189311)
end
